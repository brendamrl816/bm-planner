<h3>My Calendar</h3>


<div style="float:left; margin:15px" ng-controller="addEventCtrl as add">
    
        <button style="float:left" ng-click='add.toggleCreateEvent()'>Create New Event</button>

        <addeventmodal showmodal='add.createEvent'>
            <form name="addForm" novalidate>
                <div>
                Event: <input type="text" name="name" ng-model="add.name" required>
                <div style="float:left; color:red; font-weight:bold" ng-show="addForm.name.$invalid">*</div>
                <br><br>
                Calendar: 
                <select name="calendar" ng-model="add.calendarId">
                    <option ng-repeat="calendar in add.theCalendars.calendars" value="{{calendar.id}}">{{calendar.name}}</option>
                </select>
                <br>
                <br>
                All Day:<input type="checkbox" ng-checked="add.allDay" ng-click="add.toggleAllDay()"><br>
        
                <div style="display:inline-block; width:100%">
                    
                    <div style="float:left; width:50%; display:inline-block">
                        <minicalendars style="margin:5px; float:left" selected="add.startDate">
                            START: <input startdate type="text" id="start" size="8" ng-model="add.startDate" ng-model-options="{ updateOn: 'blur'}">
                        </minicalendars>
    
                        <div style="float:left">
                            <div style="display:inline-block; margin-top:5px; position:absolute" ng-show="!add.allDay" ng-model="add.startTime">
                                <select style="float:left" onfocus='this.size=10;' onblur='this.size=1;' onchange='this.size=1; this.blur();' ng-model="add.startHour">
                                        <option value="12">12</option>
                                        <option value="01">01</option>
                                        <option value="02">02</option>
                                        <option value="03">03</option>
                                        <option value="04">04</option>
                                        <option value="05">05</option>
                                        <option value="06">06</option>
                                        <option value="07">07</option>
                                        <option value="08">08</option>
                                        <option value="09">09</option>
                                        <option value="10">10</option>
                                        <option value="11">11</option>
                                </select>
                                <div  style="float:left">:</div>
                                <select style="float:left" onfocus='this.size=10;' onblur='this.size=1;' onchange='this.size=1; this.blur();' ng-model="add.startMinutes">
                                        <option value="00">00</option>
                                        <option value="01">01</option>
                                        <option value="02">02</option>
                                        <option value="03">03</option>
                                        <option value="04">04</option>
                                        <option value="05">05</option>
                                        <option value="06">06</option>
                                        <option value="07">07</option>
                                        <option value="08">08</option>
                                        <option value="09">09</option>
                                        <option value="10">10</option>
                                        <option value="11">11</option>
                                        <option value="12">12</option>
                                        <option value="13">13</option>
                                        <option value="14">14</option>
                                        <option value="15">15</option>
                                        <option value="16">16</option>
                                        <option value="17">17</option>
                                        <option value="18">18</option>
                                        <option value="19">19</option>
                                        <option value="20">20</option>
                                        <option value="21">21</option>
                                        <option value="22">22</option>
                                        <option value="23">23</option>
                                        <option value="24">24</option>
                                        <option value="25">25</option>
                                        <option value="26">26</option>
                                        <option value="27">27</option>
                                        <option value="28">28</option>
                                        <option value="29">29</option>
                                        <option value="30">30</option>
                                        <option value="31">31</option>
                                        <option value="32">32</option>
                                        <option value="33">33</option>
                                        <option value="34">34</option>
                                        <option value="35">35</option>
                                        <option value="36">36</option>
                                        <option value="37">37</option>
                                        <option value="38">38</option>
                                        <option value="39">39</option>
                                        <option value="40">40</option>
                                        <option value="41">41</option>
                                        <option value="42">42</option>
                                        <option value="43">43</option>
                                        <option value="44">44</option>
                                        <option value="45">45</option>
                                        <option value="46">46</option>
                                        <option value="47">47</option>
                                        <option value="48">48</option>
                                        <option value="49">49</option>
                                        <option value="50">50</option>
                                        <option value="51">51</option>
                                        <option value="52">52</option>
                                        <option value="53">53</option>
                                        <option value="54">54</option>
                                        <option value="55">55</option>
                                        <option value="56">56</option>
                                        <option value="57">57</option>
                                        <option value="58">58</option>
                                        <option value="59">59</option>
                                </select>
                                
                                <select  style="float:left" ng-model="add.startMeridiem">
                                    <option value="am">AM</option>
                                    <option value="pm">PM</option>
                                </select>
                            </div>
                        </div>
                     
                    </div>
                    
                    
                    
                    <div style="float:left; width:50%; display:inline-block">
                        <minicalendars style="margin:5px; float:left" selected="add.endDate">
                            END: <input enddate type="text" id="end" size="8" name="eventend" ng-model="add.endDate" ng-model-options="{ updateOn: 'blur', allowInvalid:true}">
                        </minicalendars>
                        
                        <div style="float:left">
                            <div style="display:inline-block; margin-top:5px; position:absolute" ng-show="!add.allDay" ng-model="add.endTime">
                                <select style="float:left" onfocus='this.size=10;' onblur='this.size=1;' onchange='this.size=1; this.blur();' ng-model="add.endHour">
                                    <option value="12">12</option>
                                    <option value="01">01</option>
                                    <option value="02">02</option>
                                    <option value="03">03</option>
                                    <option value="04">04</option>
                                    <option value="05">05</option>
                                    <option value="06">06</option>
                                    <option value="07">07</option>
                                    <option value="08">08</option>
                                    <option value="09">09</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                </select>
                                <div  style="float:left">:</div>
                                <select style="float:left" onfocus='this.size=10;' onblur='this.size=1;' onchange='this.size=1; this.blur();' ng-model="add.endMinutes">
                                        <option value="00">00</option>
                                        <option value="01">01</option>
                                        <option value="02">02</option>
                                        <option value="03">03</option>
                                        <option value="04">04</option>
                                        <option value="05">05</option>
                                        <option value="06">06</option>
                                        <option value="07">07</option>
                                        <option value="08">08</option>
                                        <option value="09">09</option>
                                        <option value="10">10</option>
                                        <option value="11">11</option>
                                        <option value="12">12</option>
                                        <option value="13">13</option>
                                        <option value="14">14</option>
                                        <option value="15">15</option>
                                        <option value="16">16</option>
                                        <option value="17">17</option>
                                        <option value="18">18</option>
                                        <option value="19">19</option>
                                        <option value="20">20</option>
                                        <option value="21">21</option>
                                        <option value="22">22</option>
                                        <option value="23">23</option>
                                        <option value="24">24</option>
                                        <option value="25">25</option>
                                        <option value="26">26</option>
                                        <option value="27">27</option>
                                        <option value="28">28</option>
                                        <option value="29">29</option>
                                        <option value="30">30</option>
                                        <option value="31">31</option>
                                        <option value="32">32</option>
                                        <option value="33">33</option>
                                        <option value="34">34</option>
                                        <option value="35">35</option>
                                        <option value="36">36</option>
                                        <option value="37">37</option>
                                        <option value="38">38</option>
                                        <option value="39">39</option>
                                        <option value="40">40</option>
                                        <option value="41">41</option>
                                        <option value="42">42</option>
                                        <option value="43">43</option>
                                        <option value="44">44</option>
                                        <option value="45">45</option>
                                        <option value="46">46</option>
                                        <option value="47">47</option>
                                        <option value="48">48</option>
                                        <option value="49">49</option>
                                        <option value="50">50</option>
                                        <option value="51">51</option>
                                        <option value="52">52</option>
                                        <option value="53">53</option>
                                        <option value="54">54</option>
                                        <option value="55">55</option>
                                        <option value="56">56</option>
                                        <option value="57">57</option>
                                        <option value="58">58</option>
                                        <option value="59">59</option>
                                </select>
                                
                                <select  style="float:left" ng-model="add.endMeridiem">
                                    <option value="am">AM</option>
                                    <option value="pm">PM</option>
                                </select>
                            </div>
                        </div> 
                    </div>
                    
                       
                    
                    <span style="color:red" ng-show="addForm.eventend.$error.enddate">* Event cannot end before it starts!</span>
                
                </div><br>
        
        
        
                Repeat: <input type="checkbox" ng-checked="add.repeats" ng-click="add.toggleRepeats()"><br>
                <div  ng-show="add.repeats">
                    <div style="float:left; color:red; font-weight:bold" ng-show="addForm.selectRepeatOcurrence.$invalid">*</div>
                    <select ng-required="add.repeats" ng-model="add.repeatOccurrence" ng-change="add.changeRepeatOptions(add.repeatOccurrence)" name="selectRepeatOcurrence">
                    <option value="">Please Select</option>
                    <option value="daily">Daily</option>
                    <option value="weekday">Every weekday(Mon-Fri)</option>
                    <option value="weekly">Weekly</option>
                    <option value="monthly">Monthly</option>
                    <option value="yearly">Yearly</option>
                    </select>
                    <br>
                    <div style="display:inline-block" ng-show="add.repeatsWeeklyMenu" ng-repeat="option in add.repeatWeeklyOptions">
                        <input ng-model="option.selected" type="checkbox">{{option.name}}
                    </div>
                    <br> 
                    <div>
                        <minicalendars style="margin:5px; float:left"  selected="add.repeatEndDate">
                            ends on: <input type="radio"  ng-model="add.repeatEndValue" ng-value="add.repeatEndDate"> 
                            date <input enddate type="text" size="8" name="repeatend" ng-model="add.repeatEndDate" ng-model-options="{ updateOn: 'blur', allowInvalid:true}">
                        </minicalendars>
                        <span style="color:red" ng-show="addForm.repeatend.$error.enddate">* Repetition cannot end before event starts!</span>
                        <div style="float:left; margin-left:10px">
                                <input type="radio"  ng-model="add.repeatEndValue" value="never">never 
                        </div>
                        
                    </div> 
                </div>
                
                <br>
                <br>
                <button ng-disabled="addForm.$invalid" ng-click="add.addEvent()">add Event</button>
                </div>
            </form>
        </addeventmodal>
       
</div>

<div ng-controller="mainCalViewCtrl" style="margin-left:15px">
    <div>
        <button ng-click="today()">Today</button> 
        <button ng-click="selectMonthly()">Monthly</button>
        <button ng-click="selectWeekly()">Weekly</button>
    </div>

<br>

    <div ng-show="monthlyView" ng-controller="monthlyViewCtrl as monthctrl"> 
        <div>
            <button style="float:left" ng-click="monthctrl.previous()"><=</button>
            <div style="float:left">{{monthctrl.calendar.selected.format('MMMM, YYYY')}}</div>
            <button style ="float:left" ng-click="monthctrl.next()">=></button>
        </div>

    <br>
  
    <div  class="bigCalStyle">
    
        <table style="width:100%">
            <tr style="height:20px">
                <th><span class="bigCalDays">Sun</span></th>
                <th><span class="bigCalDays">Mon</span></th>
                <th><span class="bigCalDays">Tue</span></th>
                <th><span class="bigCalDays">Wed</span></th>
                <th><span class="bigCalDays">Thu</span></th>
                <th><span class="bigCalDays">Fri</span></th>
                <th><span class="bigCalDays">Sat</span></th>
            </tr>
        </table>
        
        <table id="bigCalTable">    
            <tr ng-repeat="week in monthctrl.calendar.currentDisplayMonth.weeks">
                
                <td  ng-repeat-start="day in week.days" style="width:14.3%; overflow-y:auto; overflow-x:hidden">
                        <div style="position:absolute" class="bigCalDates">{{day.dateOfMonth}}</div>
                        <br>
                        <div style="position:absolute; width:98% ">
                            <div id="fire{{event.id}}{{day.dateOfMonth}}{{day.month}}" ng-style={'color':monthctrl.getColor(event)} style="margin-bottom:3px"  ng-class="eventStyle(event, day.itsDate)" class="events" ng-controller="eventCtrl" ng-repeat="event in day.events">
                                <div ng-click="toggleEventMenu()">
                                        <span style="font-size:11px" ng-show="showTime">{{event.startTimeDisplay}}</span>
                                        <span>{{event.name}}</span>
                                </div>
                
                                        <questionmodal id="{{day.dateOfMonth}}{{day.month}}" name="{{event.id}}{{day.dateOfMonth}}{{day.month}}" question='eventMenu'>
                                            <div>What would you like to do with this event?</div>
                                            <div ng-click="editEvent(event, day.itsDate)">Edit</div>
                                            <div ng-click="deleteEvent(event.repeats)">Delete</div>
                                        </questionmodal>
                                        
                                        <questionmodal id="{{day.dateOfMonth}}{{day.month}}" name="{{event.id}}{{day.dateOfMonth}}{{day.month}}" question='kindOfEdition'>
                                            <div ng-click="editThisEvent(event, day.itsDate)">This Event Only</div>
                                            <div ng-click="editAllEvents(event, day.itsDate)">All Event Repetitions</div> 
                                            <div ng-click="editFutureEvents(event, day.itsDate)">All Events Going Forward</div>
                                        </questionmodal>
                                        
                                    
                                    <questionmodal id="{{day.dateOfMonth}}{{day.month}}" name="{{event.id}}{{day.dateOfMonth}}{{day.month}}" question='verifyDeletion'>
                                        <div>Are you sure you want to delete this event?</div>
                                        <div ng-click="yesDeleteEvent(event.id)">YES</div> 
                                        <div ng-click="noDeleteEvent()">NO</div>
                                    </questionmodal>
                                    
                                    <questionmodal id="{{day.dateOfMonth}}{{day.month}}" name="{{event.id}}{{day.dateOfMonth}}{{day.month}}" question="eventsRepQuestion">
                                        <div>
                                            <div ng-click="deleteAllOcurrences(event.id)">Delete All Event Occurrences</div>
                                            <div ng-click="deleteOnlyThisOcurrance(event.id, event.eventLength, event.startDay, day.itsDate)">Delete Only This Ocurrence</div>
                                        </div>
                                    </questionmodal>
        
                            </div>
                            <br>
                    </div>
                </td>
                <td id="td{{day.dateOfMonth}}{{day.month}}" style="padding:0px; border: 1px solid transparent" ng-repeat-end></td>
            </tr>
        </table>
        
        </div>

    </div> 
    
    
    <div style="position:relative" ng-show="weeklyView" ng-controller="weekViewCtrl">
        
        <div style="display:inline-block">
            <button style="float:left; margin-left:10px" ng-click="previous()">Previous </button>
            <div style="float:left; margin-left:10px">{{calendar.selected.format('MMMM-YYYY')}}</div>
            <button style="float:left; margin-left:10px" ng-click="next()">Next </button>
        </div>
        
         <table style="margin-left:10px; margin-right:10px; width:100%";>
            <tr style="height:15px">
                <td>
                   <table style="width:100%; table-layout:fixed">
                       <tr>
                           <th>Time</th>
                       </tr>
                   </table>
               </td>
                <td ng-repeat="day in calendar.currentDisplayWeek.days">
                   <table style="width:100%; table-layout:fixed">
                       <tr>
                           <th>{{day.itsDate.format('ddd')}} {{day.itsDate.format('MM-DD')}}</th>
                       </tr>
                   </table>
                </td>
            </tr>
        </table>
        
        <div id="scrolldiv" style=" width:101%; position:relative; height:600px; margin:10px; overflow-y:scroll; border:1.5px solid gray">
         
            <table style="width:100%; height:100%; border-collapse: collapse">
                <tr style="width:100%; height:100%; position:relative">
                    <td style="width:10%; border:none">
                        <div id="anchor{{hour.id}}" style="height:30px; border: 1px solid gray" ng-repeat-start="hour in hours">{{hour.name}}</div>
                        <div style="height:30px; border: 1px solid gray" ng-repeat-end></div>
                    </td>
                    <td style="width:12.5%; border:none" ng-repeat="day in calendar.currentDisplayWeek.days">
                        <div style="height:30px; border: 1px solid gray; position:relative" ng-controller="weekEventsCtrl as weekEvents" ng-repeat="hour in day.hours">
                            <div ng-style="{'background-color':weekEvents.getColor(event.calendarId), 'width':weekEvents.getWidth($parent.$index, event), 'left':weekEvents.getLeft(event.index, event), 'height':event.height, 'top':event.top, 'position':'absolute'}"   ng-repeat="event in hour.events">
                                
                                 <div ng-style="{'background-color':'transparent', 'width':'100%',  'height':(event.rowspan * 30), 'top':'0',   'position':'absolute'}" ng-if="event.first == true"  ng-controller="eventCtrl">
                                         
                                         <div   style="background-color:transparent; height:100%; width:100%; position:absolute; z-index:3" ng-click="toggleEventMenu()">
                                             <div id="weekfire{{event.id}}{{day.dateOfMonth}}{{day.month}}" style="font-size:65%; font-weight:bold; margin-top:5px">{{event.startTimeDisplay}} {{event.name}}</div>
                                         </div>
                                         
                                         <weekquestionmodal id="{{day.dateOfMonth}}{{day.month}}" name="{{event.id}}{{day.dateOfMonth}}{{day.month}}" question='eventMenu' >
                                            <div>What would you like to do with this event?</div>
                                            <div ng-click="editEvent(event, day.itsDate)">Edit</div>
                                            <div ng-click="deleteEvent(event.repeats)">Delete</div>
                                        </weekquestionmodal>
                                        
                                        <weekquestionmodal id="{{day.dateOfMonth}}{{day.month}}" name="{{event.id}}{{day.dateOfMonth}}{{day.month}}" question='kindOfEdition'>
                                            <div ng-click="editThisEvent(event, day.itsDate)">This Event Only</div>
                                            <div ng-click="editAllEvents(event, day.itsDate)">All Event Repetitions</div> 
                                            <div ng-click="editFutureEvents(event, day.itsDate)">All Events Going Forward</div>
                                        </weekquestionmodal>
                                        
                                    
                                        <weekquestionmodal id="{{day.dateOfMonth}}{{day.month}}" name="{{event.id}}{{day.dateOfMonth}}{{day.month}}" question='verifyDeletion'>
                                            <div>Are you sure you want to delete this event?</div>
                                            <div ng-click="yesDeleteEvent(event.id)">YES</div> 
                                            <div ng-click="noDeleteEvent()">NO</div>
                                        </weekquestionmodal>
                                        
                                        <weekquestionmodal id="{{day.dateOfMonth}}{{day.month}}" name="{{event.id}}{{day.dateOfMonth}}{{day.month}}" question="eventsRepQuestion">
                                            <div>
                                                <div ng-click="deleteAllOcurrences(event.id)">Delete All Event Occurrences</div>
                                                <div ng-click="deleteOnlyThisOcurrance(event.id, event.eventLength, event.startDay, day.itsDate)">Delete Only This Ocurrence</div>
                                            </div>
                                        </weekquestionmodal>
                                 </div>
                                 
                                 
                                         
                                 
                                  
                                 
                            </div>
                           
                        </div>
                        
                    </td>
                </tr>
            </table>
            
            <!--    <div style="position:absolute; display:table-cell"></div>-->
            <!--</div>-->
         
           
                <!--<table class="weekViewOuterTable">-->
                <!--    <tr class="weekViewOuterTr">-->
                <!--        <td>-->
                <!--            <table class="weekViewInnerTable">-->
                <!--                <tr id="anchor{{hour.id}}"  class="weekViewInnerTr"  ng-repeat-start="hour in hours">-->
                <!--                    <td style="width:100%" rowspan="4" class="weekViewInnerTd">{{hour.name}}</td>-->
                <!--                </tr>-->
                <!--                <tr class="weekViewInnerTr">-->
                <!--                  <td class="weekViewInnerTdEmpty"></td>-->
                <!--                </tr>-->
                <!--                <tr class="weekViewInnerTr">-->
                <!--                  <td class="weekViewInnerTdEmpty"></td>-->
                <!--                </tr>-->
                <!--                <tr class="weekViewInnerTr" ng-repeat-end>-->
                <!--                  <td class="weekViewInnerTdEmpty"></td>-->
                <!--                </tr>-->
                                
                <!--            </table>-->
                <!--        </td>-->
                <!--        <td ng-repeat="day in calendar.currentDisplayWeek.days">-->
                <!--            <table class="weekViewInnerTable">-->
                               
                <!--               <tr style="border-bottom:1px solid transparent" class="weekViewInnerTr" ng-controller="weekEventsCtrl as weekEvents" ng-repeat-start="hour in day.hours">-->
                                   
                                      
                                      
                                      
                                      
                                 
                <!--                    <td class="weekViewInnerTdEmpty">-->
                <!--                        <div  style="border:1px solid; border-top:none; border-left:none; border-bottom:none; margin-top:1px; margin-bottom:1px"  ng-style="{'background-color':weekEvents.getColor(event.calendarId), 'width':'11.5%', 'height':event.rowspan, 'top':'0px', 'position':'absolute'}"  ng-click="showEventMenu();  $event.stopPropagation()"  ng-repeat="event in hour.events"> {{event.name}}</div>-->
                <!--                    </td>-->
                <!--               </tr>-->
                               
                <!--               <tr style="border-top:1px solid transparent; border-bottom:1px solid #C8C8C8; height:15px; font-size:65%">-->
                <!--                  <td class="weekViewInnerTdEmpty">&nbsp</td>-->
                <!--                </tr>-->
                                
                <!--                <tr style="border-bottom:1px solid transparent" class="weekViewInnerTr">-->
                <!--                  <td class="weekViewInnerTdEmpty" >&nbsp</td>-->
                <!--                </tr>-->
                               
                <!--               <tr class="weekViewInnerTr" ng-repeat-end>-->
                <!--                  <td class="weekViewInnerTdEmpty">&nbsp</td>-->
                <!--                </tr>-->
                            
                <!--            </table>-->
                <!--        </td>-->
                <!--    </tr>-->
                <!--</table>-->
     
        </div>
        
        
    </div>
    
  
   <br>
   <br>
    
</div> 

